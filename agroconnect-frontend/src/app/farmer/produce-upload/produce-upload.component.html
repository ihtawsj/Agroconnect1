<div class="container mt-4">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <div class="card shadow-sm">
        <div class="card-header bg-primary text-white">
          <div class="d-flex justify-content-between align-items-center">
            <h4 class="mb-0">
              <i class="fas fa-plus me-2"></i>
              Upload New Produce
            </h4>
            <button class="btn btn-outline-light btn-sm" (click)="goBack()">
              <i class="fas fa-arrow-left me-1"></i>Back to Dashboard
            </button>
          </div>
        </div>
        
        <div class="card-body">
          <!-- Success Message -->
          <div class="alert alert-success" *ngIf="successMessage">
            <i class="fas fa-check-circle me-2"></i>{{ successMessage }}
          </div>

          <!-- Error Message -->
          <div class="alert alert-danger" *ngIf="errorMessage">
            <i class="fas fa-exclamation-triangle me-2"></i>{{ errorMessage }}
          </div>

          <form (ngSubmit)="onSubmit()" #produceForm="ngForm">
            <div class="row">
              <!-- Left Column - Form Fields -->
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="name" class="form-label">Produce Name *</label>
                  <input 
                    type="text" 
                    class="form-control" 
                    id="name"
                    name="name"
                    [(ngModel)]="produce.name"
                    required
                    placeholder="e.g., Fresh Tomatoes"
                  >
                </div>

                <div class="mb-3">
                  <label for="category" class="form-label">Category *</label>
                  <select 
                    class="form-select" 
                    id="category"
                    name="category"
                    [(ngModel)]="produce.category"
                    required
                  >
                    <option value="">Select Category</option>
                    <option *ngFor="let cat of categories" [value]="cat.value">
                      {{ cat.label }}
                    </option>
                  </select>
                </div>

                <div class="row">
                  <div class="col-md-6">
                    <div class="mb-3">
                      <label for="quantity" class="form-label">Quantity *</label>
                      <input 
                        type="number" 
                        class="form-control" 
                        id="quantity"
                        name="quantity"
                        [(ngModel)]="produce.quantity"
                        min="1"
                        required
                        placeholder="0"
                      >
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="mb-3">
                      <label for="price" class="form-label">Price (â‚¹) *</label>
                      <input 
                        type="number" 
                        class="form-control" 
                        id="price"
                        name="price"
                        [(ngModel)]="produce.price"
                        min="0.01"
                        step="0.01"
                        required
                        placeholder="0.00"
                      >
                    </div>
                  </div>
                </div>

                <div class="mb-3">
                  <label for="description" class="form-label">Description</label>
                  <textarea 
                    class="form-control" 
                    id="description"
                    name="description"
                    [(ngModel)]="produce.description"
                    rows="3"
                    placeholder="Describe your produce (optional)"
                  ></textarea>
                </div>
              </div>

              <!-- Right Column - Image Upload -->
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="imageInput" class="form-label">Product Image *</label>
                  <div class="image-upload-container">
                    <input 
                      type="file" 
                      class="form-control" 
                      id="imageInput"
                      accept="image/*"
                      (change)="onFileSelected($event)"
                      required
                    >
                    
                    <!-- Image Preview -->
                    <div class="image-preview mt-3" *ngIf="selectedFile">
                      <img 
                        [src]="getImagePreviewUrl()" 
                        alt="Preview"
                        class="img-fluid rounded"
                        style="max-height: 200px; width: 100%; object-fit: cover;"
                      >
                      <div class="mt-2">
                        <small class="text-muted">
                          <i class="fas fa-file-image me-1"></i>
                          {{ selectedFile.name }} ({{ getFileSize() }} MB)
                        </small>
                      </div>
                    </div>

                    <!-- Upload Instructions -->
                    <div class="upload-instructions mt-3" *ngIf="!selectedFile">
                      <div class="text-center p-4 border-dashed">
                        <i class="fas fa-cloud-upload-alt fa-3x text-muted mb-3"></i>
                        <p class="text-muted mb-0">
                          <strong>Click to upload image</strong><br>
                          Supported formats: JPG, PNG, GIF<br>
                          Max size: 5MB
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Submit Button -->
            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
              <button 
                type="button" 
                class="btn btn-secondary me-md-2" 
                (click)="resetForm()"
                [disabled]="loading"
              >
                <i class="fas fa-undo me-1"></i>Reset
              </button>
              <button 
                type="submit" 
                class="btn btn-primary"
                [disabled]="loading || !produceForm.form.valid"
              >
                <span *ngIf="loading" class="spinner-border spinner-border-sm me-2"></span>
                <i *ngIf="!loading" class="fas fa-upload me-1"></i>
                {{ loading ? 'Uploading...' : 'Upload Produce' }}
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
